{% extends 'basic.html' %}
{% load static %}
{% block title %}
    {{ block.super }}
{% endblock %}
{% block description %}
    {{ block.super }}
{% endblock %}
{% block content %}
    <section class="profile">
        <div class="wrapper">
            <div class="profile-top">
                <div class="profile-row">
                    <div class="profile-user">
                        <div class="profile-img">
                            <img src="{{ request.user.get_avatar }}" alt="">
                        </div>
                        <div class="profile-info">
                            <h3 class="profile-name">{{ request.user.get_name }}</h3>
                            <span class="profile-subtitle">{{ request.user.get_nickname }}</span>
                        </div>
                    </div>
                    <div class="profile-btns">
                        <a href="{% url 'profile_edit' %}" class="profile-settings">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.2656 3.85938L13.7422 5.38281L10.6172 2.25781L12.1406 0.734375C12.2969 0.578125 12.4922 0.5 12.7266 0.5C12.9609 0.5 13.1562 0.578125 13.3125 0.734375L15.2656 2.6875C15.4219 2.84375 15.5 3.03906 15.5 3.27344C15.5 3.50781 15.4219 3.70312 15.2656 3.85938ZM0.5 12.375L9.71875 3.15625L12.8438 6.28125L3.625 15.5H0.5V12.375Z" fill="#333333"/></svg>
                            Настройки профиля
                        </a>
                        <a href="{% url 'profile_add' %}" class="profile-add">
                            <svg width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.67969 5.82031V4.17969H7.17969V1.67969H5.5V4.17969H3V5.82031H5.5V8.32031H7.17969V5.82031H9.67969ZM12.1797 3.75L15.5 0.429688V9.57031L12.1797 6.25V9.17969C12.1797 9.41406 12.0885 9.60938 11.9062 9.76562C11.75 9.92188 11.5547 10 11.3203 10H1.32031C1.08594 10 0.890625 9.92188 0.734375 9.76562C0.578125 9.60938 0.5 9.41406 0.5 9.17969V0.820312C0.5 0.585938 0.578125 0.390625 0.734375 0.234375C0.890625 0.078125 1.08594 0 1.32031 0H11.3203C11.5547 0 11.75 0.078125 11.9062 0.234375C12.0885 0.390625 12.1797 0.585938 12.1797 0.820312V3.75Z" fill="white"/></svg>
                            Добавить видео
                        </a>
                    </div>
                </div>
                <ul class="profile-list tab-list">
                    <li><a href="#tab-1" class="active">
                        <span><svg width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.1797 3.75L15.5 0.429688V9.57031L12.1797 6.25V9.17969C12.1797 9.41406 12.0885 9.60938 11.9062 9.76562C11.75 9.92188 11.5547 10 11.3203 10H1.32031C1.08594 10 0.890625 9.92188 0.734375 9.76562C0.578125 9.60938 0.5 9.41406 0.5 9.17969V0.820312C0.5 0.585938 0.578125 0.390625 0.734375 0.234375C0.890625 0.078125 1.08594 0 1.32031 0H11.3203C11.5547 0 11.75 0.078125 11.9062 0.234375C12.0885 0.390625 12.1797 0.585938 12.1797 0.820312V3.75Z" fill="#0088CC"/></svg></span>
                        <b>Пользователи</b>
                    </a></li>
                    <li><a href="#tab-2">
                        <span><svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.1797 8.32031L19.1406 8.39844H19.1797V10C19.1797 10.2083 19.1406 10.4167 19.0625 10.625L16.5234 16.4844C16.263 17.1615 15.7552 17.5 15 17.5H7.5C7.05729 17.5 6.66667 17.3307 6.32812 16.9922C5.98958 16.6536 5.82031 16.263 5.82031 15.8203V7.5C5.82031 7.05729 5.98958 6.66667 6.32812 6.32812L11.7969 0.820312L12.6953 1.71875C12.9297 1.95312 13.0469 2.23958 13.0469 2.57812V2.85156L12.2266 6.67969H17.5C17.9427 6.67969 18.3333 6.84896 18.6719 7.1875C19.0104 7.5 19.1797 7.8776 19.1797 8.32031ZM0.820312 17.5V7.5H4.17969V17.5H0.820312Z" fill="#0088CC"/></svg></span>
                        <b>Категории</b>
                    </a></li>
                    <li><a href="#tab-3">
                        <span><svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.1797 8.32031L19.1406 8.39844H19.1797V10C19.1797 10.2083 19.1406 10.4167 19.0625 10.625L16.5234 16.4844C16.263 17.1615 15.7552 17.5 15 17.5H7.5C7.05729 17.5 6.66667 17.3307 6.32812 16.9922C5.98958 16.6536 5.82031 16.263 5.82031 15.8203V7.5C5.82031 7.05729 5.98958 6.66667 6.32812 6.32812L11.7969 0.820312L12.6953 1.71875C12.9297 1.95312 13.0469 2.23958 13.0469 2.57812V2.85156L12.2266 6.67969H17.5C17.9427 6.67969 18.3333 6.84896 18.6719 7.1875C19.0104 7.5 19.1797 7.8776 19.1797 8.32031ZM0.820312 17.5V7.5H4.17969V17.5H0.820312Z" fill="#0088CC"/></svg></span>
                        <b>Видео</b>
                    </a></li>
                    <li><a href="#tab-4">
                        <span><svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.1797 8.32031L19.1406 8.39844H19.1797V10C19.1797 10.2083 19.1406 10.4167 19.0625 10.625L16.5234 16.4844C16.263 17.1615 15.7552 17.5 15 17.5H7.5C7.05729 17.5 6.66667 17.3307 6.32812 16.9922C5.98958 16.6536 5.82031 16.263 5.82031 15.8203V7.5C5.82031 7.05729 5.98958 6.66667 6.32812 6.32812L11.7969 0.820312L12.6953 1.71875C12.9297 1.95312 13.0469 2.23958 13.0469 2.57812V2.85156L12.2266 6.67969H17.5C17.9427 6.67969 18.3333 6.84896 18.6719 7.1875C19.0104 7.5 19.1797 7.8776 19.1797 8.32031ZM0.820312 17.5V7.5H4.17969V17.5H0.820312Z" fill="#0088CC"/></svg></span>
                        <b>Страницы</b>
                    </a></li>
                </ul>
            </div>
            <div class="profile-tab tab profile-post tab-active" id="tab-1">
                <table class="users-table" cellspacing="0" cellpadding="0">
                    <tr class="users-table-header">
                        <td class="users-table-header-item">E-Mail</td>
                        <td class="users-table-header-item">Nickname</td>
                        <td class="users-table-header-item">ФИО</td>
                        <td class="users-table-header-item">Дата регистрации</td>
                        <td class="users-table-header-item">Опубликованные<br>видео</td>
                        <td class="users-table-header-item">Не опубликованные видео</td>

                    </tr>

                    {% for user in all_users %}
                        <tr class="users-table-row" onclick="window.location.href = '/cp/user/{{ user.id }}'">
                            <td class="users-table-row-item">{{ user.email }}</td>
                            <td class="users-table-row-item">{{user.get_nickname}}</td>
                            <td class="users-table-row-item">{{ user.get_name }}</td>
                            <td class="users-table-row-item">{{ user.date_joined | date }}</td>
                            <td class="users-table-row-item">{{ user.get_published_videos }}</td>
                            <td class="users-table-row-item">{{ user.get_unpublished_videos }}</td>

                        </tr>
                    {% endfor %}
                </table>
            </div>
            <div class="profile-tab tab" id="tab-2">

                <div class="personalArea-row">
                    <div class="personalArea-col">
                        <div class="personalArea-wrap">
                            <div style="margin-bottom: 20px" class="category-item">
                                <div class="category-item-header">
                                    <span style="background: #0bf447" class="main-btn">Новая категория</span>
                                </div>
                            </div>
                            {% for cat in all_cats %}
                                <div class="category-item">
                                    <div class="category-item-header">
                                        <h3>{{ cat.name }}</h3>
                                        <div>
                                            <span style="background: #0bf447" class="main-btn">&#9998;</span>
                                            <span class="main-btn">&#10006;</span>
                                        </div>

                                    </div>
                                    <span>Новая подкатегория</span>
                                    <ul>
                                        {% for subcat in cat.subcat.all %}
                                            <li class="subcat_row"><p>{{ subcat.name }}</p> <p><span class="subcat_icon">&#9998;</span> <span class="subcat_icon">&#10006;</span></p></li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="personalArea-col">
                        <div class="personalArea-wrap">
                            <form action="{% url 'admin_create_category' %}" method="post" enctype="multipart/form-data">
                                {% csrf_token %}
                                <span class="personalArea-subtitle">Новая категория</span>
                                <div class="input-block">
                                    <label>Название</label>
                                    <input type="text" name="{{ newCategoryForm.name.name }}" required placeholder="Название категории" value="">
                                    <label>Изображение</label>
                                    <input style="border: none;  box-shadow: none" required name="{{ newCategoryForm.image.name }}" type="file">
                                    <label>TITLE</label>
                                    <input name="{{ newCategoryForm.page_title.name }}" required type="text">
                                    <label>KEYWORDS (через запятую)</label>
                                    <textarea name="{{ newCategoryForm.page_keywords.name }}"  id="" cols="30" rows="10"></textarea>
                                    <label>DESCRIPTION</label>
                                    <textarea name="{{ newCategoryForm.page_description.name }}" required cols="30" rows="10"></textarea>
                                    <label>SEO текст</label>
                                    <textarea style="height: 300px;resize: vertical" class="editor" name="{{ newCategoryForm.seo_text.name }}"  cols="30" rows="10"></textarea>

                                </div>
                                <button type="submit" class="personalArea-btn">
                                    <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 9.47656L14.3281 0.648438L15.5 1.82031L5.5 11.8203L0.851562 7.17188L2.02344 6L5.5 9.47656Z" fill="white"/></svg>
                                    Создать категорию
                                </button>
                            </form>


                        </div>
                    </div>
                </div>





            </div>
            <div class="profile-tab tab" id="tab-3">
                <div class="post-row">
                    {% for video in fav_videos.videos.all %}
                        {% include 'page/_video-card-small.html' %}
                    {% endfor %}
                </div>
            </div>
            <div class="profile-tab tab" id="tab-4">
                <div class="post-row">
                    {% for video in fav_videos.videos.all %}
                        {% include 'page/_video-card-small.html' %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
{% endblock %}
{% block js %}
    {{ block.super }}
    <script src="https://cdn.ckeditor.com/ckeditor5/18.0.0/classic/ckeditor.js"></script>
    <script>
        ClassicEditor.create( document.querySelector( '.editor' ) )
            .then( editor => {
                console.log( editor );
            } )
            .catch( error => {
                console.error( error );
            } );
    </script>
    <script>
        var acc = document.getElementsByClassName("accordion");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function() {
                this.classList.toggle("accordion-tab-active");
                var panel = this.nextElementSibling;
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "100px";
                }
            });
        }
    </script>
{% endblock %}